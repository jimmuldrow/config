

Open command prompt in administrator mode.

cd C:\Program Files\Java\jdk1.8.0_91\bin

keytool -genkey -keyalg RSA -alias thisalias -keystore keystore.jks -storepass passphrase -validity 360 -keysize 2048

To view, enter the following:

keytool -list -v -keystore keystore.jks

CSR (Certificate Signing Request) is created as follows:

keytool -certreq -v -alias selfsigned -file aruntest.pem -keystore keystore.jks

(Skip the certificates for development)
Import root, intermediate and server certificates as follows:

keytool -import -trustcacerts -alias root -file RootCertFileName.crt -keystore keystore.jks

keytool -import -trustcacerts -alias intermediate -file Intermediate-Digicert.crt -keystore keystore.jks

keytool -import -trustcacerts -alias selfsigned -file arunpccert.crt -keystore keystore.jks

To view keys in keystore enter:

keytool -list -keystore keystore.jks

To verify that certificates were added correctly enter:

keytool -v -list -keystore keystore.jks

Uncomment tomcat server.xml code for port 8443 and enter the path and password for the keystore.
The result should look like the following:

    <Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
               maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
               keystoreFile="c:\Program Files (x86)\Java\jdk1.8.0_65\jre\bin\keystore.jks" keystorePass="password"
               clientAuth="false" sslProtocol="TLS"                
               />


For web service security add the following to web.xml:

	<security-constraint>
         <web-resource-collection>
             <web-resource-name>validate dates</web-resource-name>
             <url-pattern>/rest/validate/dates</url-pattern>
             <http-method>GET</http-method>
             <http-method>POST</http-method>
         </web-resource-collection>
         <auth-constraint>
             <role-name>admin</role-name> 
         </auth-constraint>
	
	<!-- 
 		<user-data-constraint>
        	<transport-guarantee>CONFIDENTIAL</transport-guarantee>
    	</user-data-constraint>     
    -->
    	
    </security-constraint>
        <login-config>
            <auth-method>BASIC</auth-method>
            <realm-name>default</realm-name>
        </login-config>
    <security-role>
        <role-name>admin</role-name>
    </security-role>



Then add something like the following to tomcat-users.xml:

<user username="tom" password="foobar" roles="admin"/>





